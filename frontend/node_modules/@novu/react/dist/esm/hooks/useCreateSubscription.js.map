{"version":3,"sources":["../../../src/hooks/useCreateSubscription.ts"],"sourcesContent":["import { CreateSubscriptionArgs, NovuError, TopicSubscription } from '@novu/js';\nimport { useCallback, useRef, useState } from 'react';\nimport { useNovu } from './NovuProvider';\n\nexport type UseCreateSubscriptionProps = {\n  onSuccess?: (data: TopicSubscription) => void;\n  onError?: (error: NovuError) => void;\n};\n\nexport type UseCreateSubscriptionResult = {\n  isCreating: boolean;\n  error?: NovuError;\n  create: (args: CreateSubscriptionArgs) => Promise<{\n    data?: TopicSubscription | undefined;\n    error?: NovuError | undefined;\n  }>;\n};\n\nexport const useCreateSubscription = (props: UseCreateSubscriptionProps = {}): UseCreateSubscriptionResult => {\n  const propsRef = useRef<UseCreateSubscriptionProps>(props);\n  propsRef.current = props;\n  const novu = useNovu();\n  const [isCreating, setIsCreating] = useState(false);\n  const [error, setError] = useState<NovuError>();\n\n  const create = useCallback(\n    async (args: CreateSubscriptionArgs) => {\n      const { onSuccess, onError } = propsRef.current;\n      setError(undefined);\n      setIsCreating(true);\n\n      const response = await novu.subscriptions.create(args);\n\n      setIsCreating(false);\n\n      if (response.error) {\n        setError(response.error);\n        onError?.(response.error);\n      } else if (response.data) {\n        onSuccess?.(response.data);\n      }\n\n      return response;\n    },\n    [novu]\n  );\n\n  return {\n    create,\n    isCreating,\n    error,\n  };\n};\n"],"mappings":";AACA,SAAS,aAAa,QAAQ,gBAAgB;AAC9C,SAAS,eAAe;AAgBjB,IAAM,wBAAwB,CAAC,QAAoC,CAAC,MAAmC;AAC5G,QAAM,WAAW,OAAmC,KAAK;AACzD,WAAS,UAAU;AACnB,QAAM,OAAO,QAAQ;AACrB,QAAM,CAAC,YAAY,aAAa,IAAI,SAAS,KAAK;AAClD,QAAM,CAAC,OAAO,QAAQ,IAAI,SAAoB;AAE9C,QAAM,SAAS;AAAA,IACb,OAAO,SAAiC;AACtC,YAAM,EAAE,WAAW,QAAQ,IAAI,SAAS;AACxC,eAAS,MAAS;AAClB,oBAAc,IAAI;AAElB,YAAM,WAAW,MAAM,KAAK,cAAc,OAAO,IAAI;AAErD,oBAAc,KAAK;AAEnB,UAAI,SAAS,OAAO;AAClB,iBAAS,SAAS,KAAK;AACvB,kBAAU,SAAS,KAAK;AAAA,MAC1B,WAAW,SAAS,MAAM;AACxB,oBAAY,SAAS,IAAI;AAAA,MAC3B;AAEA,aAAO;AAAA,IACT;AAAA,IACA,CAAC,IAAI;AAAA,EACP;AAEA,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,EACF;AACF;","names":[]}