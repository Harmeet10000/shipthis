// src/hooks/useSchedule.ts
import { useEffect, useState } from "react";
import { useNovu } from "./NovuProvider.js";
var useSchedule = (props) => {
  const { onSuccess, onError } = props || {};
  const [data, setData] = useState();
  const { preferences, on } = useNovu();
  const [error, setError] = useState();
  const [isLoading, setIsLoading] = useState(true);
  const [isFetching, setIsFetching] = useState(false);
  const sync = (event) => {
    if (!event.data) {
      return;
    }
    setData(event.data);
  };
  useEffect(() => {
    fetchSchedule();
    const listUpdatedCleanup = on("preference.schedule.get.updated", sync);
    const listPendingCleanup = on("preference.schedule.get.pending", sync);
    const listResolvedCleanup = on("preference.schedule.get.resolved", sync);
    return () => {
      listUpdatedCleanup();
      listPendingCleanup();
      listResolvedCleanup();
    };
  }, []);
  const fetchSchedule = async () => {
    setIsFetching(true);
    const response = await preferences.schedule.get();
    if (response.error) {
      setError(response.error);
      onError?.(response.error);
    } else {
      onSuccess?.(response.data);
    }
    setIsLoading(false);
    setIsFetching(false);
  };
  const refetch = () => {
    preferences.schedule.cache.clearAll();
    return fetchSchedule();
  };
  return {
    schedule: data,
    error,
    isLoading,
    isFetching,
    refetch
  };
};
export {
  useSchedule
};
//# sourceMappingURL=useSchedule.js.map