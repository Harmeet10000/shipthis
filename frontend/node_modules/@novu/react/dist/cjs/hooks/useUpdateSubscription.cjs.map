{"version":3,"sources":["../../../src/hooks/useUpdateSubscription.ts"],"sourcesContent":["import { BaseUpdateSubscriptionArgs, NovuError, TopicSubscription, UpdateSubscriptionArgs } from '@novu/js';\nimport { useCallback, useRef, useState } from 'react';\nimport { useNovu } from './NovuProvider';\n\nexport type UseUpdateSubscriptionProps = {\n  onSuccess?: (data: TopicSubscription) => void;\n  onError?: (error: NovuError) => void;\n};\n\ntype UpdateResult = Promise<{\n  data?: TopicSubscription | undefined;\n  error?: NovuError;\n}>;\n\nexport type UseUpdateSubscriptionResult = {\n  isUpdating: boolean;\n  error?: NovuError;\n  update: (args: UpdateSubscriptionArgs) => UpdateResult;\n};\n\nexport const useUpdateSubscription = (props: UseUpdateSubscriptionProps = {}): UseUpdateSubscriptionResult => {\n  const propsRef = useRef<UseUpdateSubscriptionProps>(props);\n  propsRef.current = props;\n  const novu = useNovu();\n  const [isUpdating, setIsUpdating] = useState(false);\n  const [error, setError] = useState<NovuError>();\n\n  const update = useCallback(\n    async (args: UpdateSubscriptionArgs): UpdateResult => {\n      const { onSuccess, onError } = propsRef.current;\n      setError(undefined);\n      setIsUpdating(true);\n\n      const response = await novu.subscriptions.update(args as BaseUpdateSubscriptionArgs);\n\n      setIsUpdating(false);\n\n      if (response.error) {\n        setError(response.error);\n        onError?.(response.error);\n      } else if (response.data) {\n        onSuccess?.(response.data);\n      }\n\n      return response;\n    },\n    [novu]\n  );\n\n  return {\n    update,\n    isUpdating,\n    error,\n  };\n};\n"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,mBAA8C;AAC9C,0BAAwB;AAkBjB,IAAM,wBAAwB,CAAC,QAAoC,CAAC,MAAmC;AAC5G,QAAM,eAAW,qBAAmC,KAAK;AACzD,WAAS,UAAU;AACnB,QAAM,WAAO,6BAAQ;AACrB,QAAM,CAAC,YAAY,aAAa,QAAI,uBAAS,KAAK;AAClD,QAAM,CAAC,OAAO,QAAQ,QAAI,uBAAoB;AAE9C,QAAM,aAAS;AAAA,IACb,OAAO,SAA+C;AACpD,YAAM,EAAE,WAAW,QAAQ,IAAI,SAAS;AACxC,eAAS,MAAS;AAClB,oBAAc,IAAI;AAElB,YAAM,WAAW,MAAM,KAAK,cAAc,OAAO,IAAkC;AAEnF,oBAAc,KAAK;AAEnB,UAAI,SAAS,OAAO;AAClB,iBAAS,SAAS,KAAK;AACvB,2CAAU,SAAS;AAAA,MACrB,WAAW,SAAS,MAAM;AACxB,+CAAY,SAAS;AAAA,MACvB;AAEA,aAAO;AAAA,IACT;AAAA,IACA,CAAC,IAAI;AAAA,EACP;AAEA,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,EACF;AACF;","names":[]}